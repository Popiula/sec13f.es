---
title: "Manual de uso del paquete \"sec13f.es\""
author: "Ana Guardia"
date: "`r Sys.Date()`"
output: 
        rmarkdown::html_vignette:
        fig_caption: yes
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
## Introduccion

El objetivo de este paquete es facilitar al usuario de R una herramienta para crear un dataset con los datos historicos y actuales de los formularios 13f que la SEC pone a disposicion del publico a traves de la plataforma EDGAR. 

En este manual se explica, con ejemplos, la funcionalidad del paquete.

## funcion: indice13f()

Construye un indice que se utiliza en un paso posterior para recorrer los archivos de texto alojados en EDGAR que contienen la informacion de los formularios 13f.

Devuelve un dataframe con el indice y ademas lo carga en una coleccion de mongoDB.

```{r, include = T}
# library(sec13f)
# indice13f()
# master <- indice13f(periodo = 2019, 
#                    nombreColeccion = indice13f,
#                    nombreBD = sec13f,
#                    mongoURL = 'mongodb://localhost:27017'
#                    )
# library(mongolite)
# conexion <- 
```

## funcion: recorreFormularios()

Utiliza el indice construido con la funcion anterior: `indice13f()` para recorrer los formularios y extraer los datos utilizando la funcion `extraeDatos()`.

```{r, include = T}

# recorreFormularios(coleccion = paste0(format(Sys.Date(), "%Y%m%d"), "indice"), 
#                    db = paste0(format(Sys.Date(), "%Y%m%d"), "sec13f"), 
#                    mongoURL = "mongodb://localhost:27017")
```

## funcion: extraeDatos()

Toma como input un archivo de texto en el formato de los archivos que contienen la información de los 13f en la pagina web de EDGAR de la SEC y devuelve una lista con dos elementos:   

+ dataframe con los datos descriptivos del formulario  
+ dataframe con la tabla de inversiones del formulario  

Por ejemplo, el [formulario 13f de AQR Capital Management LLC del cuarto trimestre de 2018](https://www.sec.gov/Archives/edgar/data/1167557/000108514619000779/0001085146-19-000779.txt)

```{r, include = T}
# extraeDatos("https://www.sec.gov/Archives/edgar/data/1167557/000108514619000779/0001085146-19-000779.txt")
```



## Styles

The `html_vignette` template includes a basic CSS theme. To override this theme you can specify your own CSS in the document metadata as follows:

    output: 
      rmarkdown::html_vignette:
        css: mystyles.css

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))

Note the various macros within the `vignette` section of the metadata block above. These are required in order to instruct R how to build the vignette. Note that you should change the `title` field and the `\VignetteIndexEntry` to match the title of your vignette.


